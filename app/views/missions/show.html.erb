<div class = "container bg-white">

<div class = "d-flex justify-content-between mt-5 bg-white p-3" style="box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);">
  <div>
    <h1 class= "font-weight-bold "> <%= @mission.title.capitalize  %></h1>
      <h4><%= @mission.location.capitalize %></h4>
  </div>
  <div>
    <p>Organisé par : </p>
    <div class = "avatar-large" >
     <% if @mission.user.photo.attached? %>
      <%=cl_image_tag @mission.user.photo.key, height: 160, width: 160, crop: :fill, radius: 40, gravity: :face%>
    <% else %>
      <%= image_tag "photo-avatar-profil.png", class: "avatar-large"%>
    <% end %>
    </div>
  </div>
</div>

<div class = "my-5" style="box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);">
<div class = "d-flex justify-content-between p-3">
  <% if @mission.photo.attached? %>
    <%= cl_image_tag @mission.photo.key, width: 600, height: 200, crop: :fill %>
  <% else %>
    <%= cl_image_tag("jcflwedvuuwwkihvec2k", width: 600, height: 200, crop: :fill) %>
  <% end %>
  <div>
  <p class= "font-weight-bold ">  <i class="fas fa-map-marker-alt"></i> Localisation : </p><p><%= @mission.location.capitalize %></p>
  <p class= "font-weight-bold "><i class="far fa-clock"></i> Date : </p> <p>Du <%= @mission.start_time.strftime("%d/%m/%Y") %> à <%= @mission.end_time.strftime("%k:%M") %> </p> <p>Au <%= @mission.start_time.strftime("%d/%m/%Y") %> à <%= @mission.start_time.strftime("%k:%M") %> </p>
  </div>
</div>
  <div class = "d-flex justify-content-between p-3">
 <div class = "mr-5">
      <p class = "mt-3 font-weight-bold "> Description : </p>
      <p style="width: 600px"><%= @mission.description.capitalize %></p>
  </div>
      <div id="map"
     style="width: 200px; height: 150px;"
     data-markers="<%= @markers.to_json %>"
     data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>
</div>

<div class = "p-3" style="box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);">
  <% if @mission.quota %>
   <p>Pour que cette mission soit un succès, nous avons besoin de <%= @mission.quota %> bénévoles</p>
  <p class= "font-weight-bold ">Participants (<%= @mission.participations.count%>/<%= @mission.quota %>)</p> 
  <% end %>

<% @mission.users.each do |user| %>
   <% if user.photo.attached? %>
      <%=cl_image_tag user.photo.key, height: 120, width: 120, crop: :fill, radius: 100, gravity: :face, class: "mr-1 mb-1" %>
    <% else %>
      <%= image_tag "photo-avatar-profil.png", class: "avatar-large mr-1 mb-1 " %>
    <% end %>
<% end %>
<%= image_tag "photo-avatar-profil.png", class: "avatar-large mr-1 mb-1 " %>
</div>

<div class = "d-flex justify-content-between mt-5 mx-4">
  <%= link_to "RETOUR", missions_path, class: "btn btn-ghost" %>
  <% if policy(@mission).destroy? %>
    <%= link_to "SUPPRIMER", mission_path(@mission), method: :delete, class: "btn btn-ghost red-bg"  %>
<% end %>  
<% if @mission.users.include?(current_user) %>
    <%= link_to "SE DESINSCRIRE", mission_participation_path(@mission), method: :delete, class: "btn btn-ghost" %>
  <% else %>
    <%= link_to "PARTICIPER", mission_participations_path(@mission), method: "post", class: "btn btn-ghost-blue"  %>
  <% end %>
</div>
</div>
